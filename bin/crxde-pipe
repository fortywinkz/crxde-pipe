#!/usr/bin/env node
'use strict';

var program = require('commander'),
    pkg = require('../package.json'),
    crxdePipe = require('../'),
    paths = [ process.cwd() ],
    options = {},
    util = require('util');

program
  .description('Pipes source code to CQ (CRXDE)')
  .version(pkg.version)
  .usage('[options] <dir...>')
  .option('-c, --config [path]', 'Path to configuration file')
  .parse(process.argv);

if (program.args.length) {
  paths = program.args;
}

program.options.forEach(function(option) {
  var key = option.name(),
      val = program[key];

  if (val != null && key !== 'version') {
    options[key] = program[key];
  }
});

crxdePipe.pipe(paths, options.config);
